# 

""-""-""-""
""t""i""t""l""e"":"" """""L""C""P"" ""3""2""：""批""量""处""理""任""务""（""★""★""）"""""
""t""i""t""l""e""_""e""n"":"" """""t""3""f""K""g""1"""""
""d""a""t""e"":"" ""2""0""2""1""-""0""4""-""0""5""T""0""0"":""0""0"":""0""0""+""0""8"":""0""0""
""d""r""a""f""t"":"" ""f""a""l""s""e""
""l""e""e""t""c""o""d""e""_""t""a""g""s"":"" "" ""[""力""扣""杯"",""困""难"",""贪""心""]""
""s""c""o""r""e"":"" ""
""-""-""-""
""
"">"" ""<""u"">""*""*""[""力""扣""杯"" ""2""0""2""1"" ""春""季""个""人""赛""第"" ""5"" ""题""]""(""h""t""t""p""s"":""/""/""l""e""e""t""c""o""d""e"".""c""n""/""p""r""o""b""l""e""m""s""/""t""3""f""K""g""1""/"")""*""*""<""/""u"">""
""
""#""#"" ""题""目""
""
""某""实""验""室""计""算""机""待""处""理""任""务""以"" ""`""[""s""t""a""r""t"",""e""n""d"",""p""e""r""i""o""d""]""`"" ""格""式""记""于""二""维""数""组"" ""`""t""a""s""k""s""`""，""表""示""完""成""该""任""务""的""时""间""范""围""为""起""始""时""间"" ""`""s""t""a""r""t""`"" ""至""结""束""时""间"" ""`""e""n""d""`"" ""之""间""，""需""要""计""算""机""投""入"" ""`""p""e""r""i""o""d""`"" ""的""时""长""，""注""意""：""
""1""."" ""`""p""e""r""i""o""d""`"" ""可""为""不""连""续""时""间""
""2""."" ""首""尾""时""间""均""包""含""在""内""
""
""处""于""开""机""状""态""的""计""算""机""可""同""时""处""理""任""意""多""个""任""务""，""请""返""回""电""脑""最""少""开""机""多""久""，""可""处""理""完""所""有""任""务""。""
""
""*""*""示""例"" ""1""：""*""*""
"">""输""入""：""`""t""a""s""k""s"" ""="" ""[""[""1"",""3"",""2""]"",""[""2"",""5"",""3""]"",""[""5"",""6"",""2""]""]""`""
"">""
"">""输""出""：""`""4""`""
"">""
"">""解""释""：""
"">""t""a""s""k""s""[""0""]"" ""选""择""时""间""点"" ""2""、""3""；""
"">""t""a""s""k""s""[""1""]"" ""选""择""时""间""点"" ""2""、""3""、""5""；""
"">""t""a""s""k""s""[""2""]"" ""选""择""时""间""点"" ""5""、""6""；""
"">""因""此""计""算""机""仅""需""在""时""间""点"" ""2""、""3""、""5""、""6"" ""四""个""时""刻""保""持""开""机""即""可""完""成""任""务""。""
""
""*""*""示""例"" ""2""：""*""*""
"">""输""入""：""`""t""a""s""k""s"" ""="" ""[""[""2"",""3"",""1""]"",""[""5"",""5"",""1""]"",""[""5"",""6"",""2""]""]""`""
"">""
"">""输""出""：""`""3""`""
"">""
"">""解""释""：""
"">""t""a""s""k""s""[""0""]"" ""选""择""时""间""点"" ""2"" ""或"" ""3""；""
"">""t""a""s""k""s""[""1""]"" ""选""择""时""间""点"" ""5""；""
"">""t""a""s""k""s""[""2""]"" ""选""择""时""间""点"" ""5""、""6""；""
"">""因""此""计""算""机""仅""需""在""时""间""点"" ""2""、""5""、""6"" ""或"" ""3""、""5""、""6"" ""三""个""时""刻""保""持""开""机""即""可""完""成""任""务""。""
""
""*""*""提""示""：""*""*""
""-"" ""`""2"" ""<""="" ""t""a""s""k""s"".""l""e""n""g""t""h"" ""<""="" ""1""0""^""5""`""
""-"" ""`""t""a""s""k""s""[""i""]"".""l""e""n""g""t""h"" ""=""="" ""3""`""
""-"" ""`""0"" ""<""="" ""t""a""s""k""s""[""i""]""[""0""]"" ""<""="" ""t""a""s""k""s""[""i""]""[""1""]"" ""<""="" ""1""0""^""9""`""
""-"" ""`""1"" ""<""="" ""t""a""s""k""s""[""i""]""[""2""]"" ""<""="" ""t""a""s""k""s""[""i""]""[""1""]""-""t""a""s""k""s""[""i""]""[""0""]"" ""+"" ""1""`""
""
""
""#""#"" ""分""析""
""
""#""#""#"" ""#""1""
""
""为""了""方""便""，""可""以""先""将""所""有"" ""e""n""d"" ""加"" ""1"" ""变""为""左""开""右""闭""区""间"" ""[""s""t""a""r""t"","" ""e""n""d"")""。""
""
""将"" ""t""a""s""k""s"" ""按""结""束""时""间"" ""e""n""d"" ""排""序""。""直""觉""上""，""先""结""束""的""任""务""应""该""用""尽""可""能""晚""的""时""间""点""，""能""够""最""大""化""地""节""省""后""续""任""务""的""时""间""。""
""简""单""证""明""一""下""：""
""
""	""假""设""最""优""方""案""的""时""间""点""集""合""为"" ""T""，""首""个""任""务"" ""(""s""0"","" ""e""0"","" ""p""0"")"" ""，""在""最""优""方""案""中""的""时""间""点""集""合""为"" ""T""0""。""
""	""
""	""将"" ""T""0"" ""变""为""最""晚""的""区""间"" ""[""e""0""-""p""0""+""1"","" ""e""0"")""，""任""一""后""续""任""务"" ""i"" ""依""然""能""完""成""：""
""	""若"" ""s""i"" ""<""="" ""s""0"" ""或""者"" ""s""i"" "">""="" ""e""0""	""	""[""s""i"","" ""e""i""]"" ""内""的""时""间""点""个""数""不""变""
""	""若"" ""s""0"" ""<"" ""s""i"" ""<"" ""e""0""	""	""	""	""	""[""s""i"","" ""e""i""]"" ""内""的""时""间""点""个""数""不""变""或""变""多""
""	""
""	""因""此""首""个""任""务""用""尽""可""能""晚""的""时""间""点""，""不""会""比""最""优""方""案""差""。""
""	""
""	""后""续""任""务""依""此""类""推""。""
""
""具""体""实""现""：""
""
""	""用"" ""s""t""a""c""k"" ""来""保""存""已""经""确""定""的""时""间""区""间"" ""[""x""0"","" ""y""0"")""、""[""x""1"","" ""y""1"")""、""[""x""2"","" ""y""2"")""、"".""."".""。""
""	""
""	""遍""历""任""务"" ""i""，""先""计""算""已""经""完""成""的""时""间""点"" ""a""l""r""e""a""d""y""，""
""	""再""从"" ""[""s""i"","" ""e""i"")"" ""中""的""空""隙""完""成""剩""下""的""时""间""点"" ""e""x""t""r""a""=""m""a""x""(""0"","" ""p""i""-""a""l""r""e""a""d""y"")""。""
""
""	""因""为""要""尽""可""能""晚""，""所""以""从""后""往""前""看""。""先""看""最""后""一""个""区""间""结""尾"" ""s""t""a""c""k""[""-""1""]""[""1""]"" ""和""当""前""边""界"" ""c""u""r""=""e""i"" ""之""间""的""空""隙""够""不""够""。""
""	""
""	""若""空""隙""足""够""	""	""	""新""加""一""个""区""间""	""[""c""u""r""-""e""x""t""r""a"","" ""e""i"")""	""
""	""
""	""若""空""隙""不""够""	""	""	""出""栈""最""后""一""个""区""间""，""更""新"" "" ""e""x""t""r""a"" ""-""="" ""c""u""r"" ""-"" ""s""t""a""c""k""[""-""1""]""[""1""]""，""c""u""r"" ""="" ""s""t""a""c""k""[""-""1""]""[""0""]""
""	""	""	""	""	""	""再""重""复""以""上""过""程""
""	""	""	""	""	""	""
""	""最""终""计""算"" ""s""t""a""c""k"" ""中""的""时""间""点""个""数""即""可""。""
""
""`""`""`""p""y""t""h""o""n""
""d""e""f"" ""p""r""o""c""e""s""s""T""a""s""k""s""(""s""e""l""f"","" ""t""a""s""k""s"":"" ""L""i""s""t""[""L""i""s""t""[""i""n""t""]""]"")"" ""-"">"" ""i""n""t"":""
""	""t""a""s""k""s"".""s""o""r""t""(""k""e""y""=""l""a""m""b""d""a"" ""x"":"" ""x""[""1""]"")""
""	""s""t""a""c""k"" ""="" ""[""]""
""	""f""o""r"" ""s""t""a""r""t"","" ""e""n""d"","" ""p""e""r""i""o""d"" ""i""n"" ""t""a""s""k""s"":""
""	""	""e""n""d"" ""+""="" ""1""
""	""	""a""l""r""e""a""d""y"" ""="" ""s""u""m""(""y""-""m""a""x""(""x"","" ""s""t""a""r""t"")"" ""f""o""r"" ""x"","" ""y"" ""i""n"" ""s""t""a""c""k"" ""i""f"" ""y"" "">"" ""s""t""a""r""t"")""
""	""	""e""x""t""r""a"" ""="" ""m""a""x""(""0"","" ""p""e""r""i""o""d""-""a""l""r""e""a""d""y"")""
""	""	""c""u""r"" ""="" ""e""n""d""
""	""	""w""h""i""l""e"" ""s""t""a""c""k"" ""a""n""d"" ""c""u""r""-""s""t""a""c""k""[""-""1""]""[""1""]"" ""<""="" ""e""x""t""r""a"":""
""	""	""	""x"","" ""y"" ""="" ""s""t""a""c""k"".""p""o""p""("")""
""	""	""	""e""x""t""r""a"" ""-""="" ""c""u""r""-""y""
""	""	""	""c""u""r"" ""="" ""x""
""	""	""s""t""a""c""k"".""a""p""p""e""n""d""(""[""c""u""r""-""e""x""t""r""a"","" ""e""n""d""]"")""
""	""r""e""t""u""r""n"" ""s""u""m""(""y""-""x"" ""f""o""r"" ""x"","" ""y"" ""i""n"" ""s""t""a""c""k"")""
""`""`""`""
""
""超""时""了""
""
""#""#""#"" ""#""2""
""
""超""时""的""原""因""是""每""次""计""算"" ""a""l""r""e""a""d""y"" ""都""遍""历"" ""s""t""a""c""k""，""最""坏""时""间""复""杂""度"" ""$""O""(""N""^""2"")""$""。""
""
""要""优""化""子""数""组""计""算""，""容""易""想""到""前""缀""和""。""考""虑""每""次""入""栈""时""间""区""间"" ""[""x""j"","" ""y""j"")"" ""时""，""额""外""保""存""所""有""已""确""定""的""时""间""点""总""数"" ""S""j""。""
""那""么""计""算""任""务""的"" ""a""l""r""e""a""d""y"" ""时"":""
""
""	""先""二""分""查""找""找""到""第""一""个""大""于"" ""s""t""a""r""t"" ""的"" ""y""j""
""	""
""	""s""t""a""c""k""[""-""1""]""[""2""]"" ""-"" ""S""j"" ""就""是""除""了""区""间"" ""[""x""j"","" ""y""j"")"" ""以""外""任""务""已""完""成""的""时""间""点""总""数""
""	""
""	""区""间"" ""[""x""j"","" ""y""j"")"" ""内""任""务""已""完""成""的""时""间""点""个""数""是"" "" ""y""j"" ""-"" ""m""a""x""(""x""j"","" ""s""t""a""r""t"")""
""	""
""	""a""l""r""e""a""d""y"" ""="" ""s""t""a""c""k""[""-""1""]""[""2""]"" ""-"" ""S""j"" ""+"" ""y""j"" ""-"" ""m""a""x""(""x""j"","" ""s""t""a""r""t"")""
""	""
""最""终""也""无""需""再""遍""历"" ""s""t""a""c""k"" ""计""算""，""s""t""a""c""k""[""-""1""]""[""2""]"" ""即""为""所""求""。""
""
""另""外""，""二""分""查""找""可""以""借""助"" ""p""y""t""h""o""n"" ""的""魔""法""方""法""节""省""代""码""。""
""
""#""#"" ""解""答""
""
""`""`""`""p""y""t""h""o""n""
""d""e""f"" ""p""r""o""c""e""s""s""T""a""s""k""s""(""s""e""l""f"","" ""t""a""s""k""s"":"" ""L""i""s""t""[""L""i""s""t""[""i""n""t""]""]"")"" ""-"">"" ""i""n""t"":""
""	""t""a""s""k""s"".""s""o""r""t""(""k""e""y""=""l""a""m""b""d""a"" ""x"":"" ""x""[""1""]"")""
""	""s""e""l""f"".""_""_""c""l""a""s""s""_""_"".""_""_""g""e""t""i""t""e""m""_""_"" ""="" ""l""a""m""b""d""a"" ""s""e""l""f"","" ""i"":"" ""s""t""a""c""k""[""i""]""[""1""]"">""s""t""a""r""t""
""	""s""t""a""c""k"" ""="" ""[""]""
""	""f""o""r"" ""s""t""a""r""t"","" ""e""n""d"","" ""p""e""r""i""o""d"" ""i""n"" ""t""a""s""k""s"":""
""	""	""e""n""d"" ""+""="" ""1""
""	""	""i"" ""="" ""b""i""s""e""c""t""_""l""e""f""t""(""s""e""l""f"","" ""T""r""u""e"","" ""0"","" ""l""e""n""(""s""t""a""c""k"")"")""
""	""	""a""l""r""e""a""d""y"" ""="" ""0"" ""i""f"" ""i""=""=""l""e""n""(""s""t""a""c""k"")"" ""e""l""s""e"" ""s""t""a""c""k""[""-""1""]""[""2""]""-""s""t""a""c""k""[""i""]""[""2""]""+""s""t""a""c""k""[""i""]""[""1""]""-""m""a""x""(""s""t""a""r""t"","" ""s""t""a""c""k""[""i""]""[""0""]"")""
""	""	""e""x""t""r""a"" ""="" ""m""a""x""(""0"","" ""p""e""r""i""o""d""-""a""l""r""e""a""d""y"")""
""	""	""c""u""r"" ""="" ""e""n""d""
""	""	""w""h""i""l""e"" ""s""t""a""c""k"" ""a""n""d"" ""c""u""r""-""s""t""a""c""k""[""-""1""]""[""1""]"" ""<""="" ""e""x""t""r""a"":""
""	""	""	""x"","" ""y"","" ""_"" ""="" ""s""t""a""c""k"".""p""o""p""("")""
""	""	""	""e""x""t""r""a"" ""-""="" ""c""u""r""-""y""
""	""	""	""c""u""r"" ""="" ""x""
""	""	""s""t""a""c""k"".""a""p""p""e""n""d""(""[""c""u""r""-""e""x""t""r""a"","" ""e""n""d"","" ""e""n""d""-""c""u""r""+""e""x""t""r""a"" ""+"" ""(""s""t""a""c""k""[""-""1""]""[""2""]"" ""i""f"" ""s""t""a""c""k"" ""e""l""s""e"" ""0"")""]"")""
""	""r""e""t""u""r""n"" ""s""t""a""c""k""[""-""1""]""[""2""]""
""`""`""`""
""
""1""7""1""2"" ""m""s""
""
""
